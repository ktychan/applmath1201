%! TeX program = lualatex
\documentclass[../main.tex]{subfiles}
\begin{document} \section{Solving systems of recurrence equations}
With the ability to find eigenvectors with their corresponding eigenvalues, we can now solve systems of recurrence equations and get better answer than \(\vec{x}(t) = A^{t} \vec{x}(0)\).

\begin{method} \label{method:recurrences-system}
  The solution for \(\vec{x}(t + 1) = A\vec{x}(t)\) with initial condition \(\vec{x}(0)\) is
  \begin{equation} \label{eq:solutions-for-recurrence-systems}
    \vec{x}(t) = \alpha \mu^{t} \vec{u} + \beta \lambda^{t} \vec{v},
  \end{equation}
  where \(\vec{x}(0) = \alpha \vec{u} + \beta \vec{v}\), \(\mu\) is the eigenvalue for \(\vec{u}\), and \(\lambda\) the eigenvalue for \(\vec{v}\).

  Equation~\eqref{eq:solutions-for-recurrence-systems} works because \(A^{t} \vec{v} = \lambda^{t} \vec{v}\). We apply this method in three steps.
  \begin{enumerate}
    \item Use Method~\ref{method:eigenvectors} to find eigenvectors \(\vec{u}\) and \(\vec{v}\) with their corresponding eigenvalues. 
    \item Use Method~\ref{method:linear-combination} to express \(\vec{x}(0)\) in terms of \(\vec{u}\) and \(\vec{v}\), i.e., find \(\alpha\) and \(\beta\).
    \item Apply Equation \ref{eq:solutions-for-recurrence-systems}.
  \end{enumerate}
\end{method}

\begin{example}[Textbook page~187] \label{eq:age-structured-recurrence-solution}
  Solve \( \vec{x}(t+1) = \begin{bmatrix} 0 & 6 \\ 1/4 & 1/2 \end{bmatrix} \vec{x}(t) \) with \(\vec{x}(0) = \begin{bmatrix} 4 \\ 2 \end{bmatrix}\).

  \begin{enumerate}[wide, label=(Step~\arabic*)]
    \item Use Method~\ref{method:eigenvectors} to find eigenvectors \(\vec{u}\) and \(\vec{v}\) with their corresponding eigenvalues. 
      \blanklines{5}

    \item Use Method~\ref{method:linear-combination} to express \(\vec{x}(0)\) in terms of \(\vec{u}\) and \(\vec{v}\), i.e., find \(\alpha\) and \(\beta\).

      \blanklines{15}

    \item Apply Equation \ref{eq:solutions-for-recurrence-systems}. 
      \blanklines{5}
  \end{enumerate}
\end{example}
\clearpage

Why is Equation~\eqref{eq:solutions-for-recurrence-systems} \emph{the} solution for \(\vec{x}(t+1) = A \vec{x}(t)\)? 
\blanklines{15}

The underlying mathematics for age-structured population can be applied to any systems involving two groups or quantities. Here is an example combining probabilities and systems of recurrence equations for weather forecast. It is also meant as a comprehensive example for Method~\ref{method:recurrences-system}. 

\begin{example} \label{ex:weather-forecast}
  Consider the weather in the summer where rain and not rain are the only possibilities.  If it is currently raining, then there is a \(75\%\) chance of rain in the next hour. If it is currently not raining, then there is \(40\%\) of rain in the next hour.  Initially, there is a \(50\%\) chance of rain.  

  Sketch the transition diagram. Find the probabilities of rain and not rain, respectively, \(24\) hours after the initial hour.  In the final answer, use a calculator to approximate powers of \emph{constants} to two decimal places. If this was an exam question, then we can leave powers of \emph{constants} unsimplified.

  \blanklines{25}
  \clearpage

  \blanklines{50}
\end{example}
\end{document}

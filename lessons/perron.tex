%! TeX program = lualatex
\documentclass[../main.tex]{subfiles}
\begin{document} \section{Long-term behaviour of recurrence equations (with primitive matricies)}

We start with a hidden pattern of Example~\ref{ex:weather-forecast} whose recurrence is
\[
  \vec{p}(t+1) = 
  \begin{bmatrix}
    0.75 & 0.4 \\
    0.25 & 0.6
  \end{bmatrix}
  \vec{p}(t)
  \quad\text{and}\quad
  \vec{p}(0) = 
  \begin{bmatrix}
    0.5 \\ 0.5
  \end{bmatrix}
  \begin{array}{r}
    \text{rain} \\
    \text{no rain}
  \end{array}.
\]

A hidden pattern emerges when we \emph{arbitrarily} change the initial condition.
\[
  \begin{array}{rclcrclc}
    A^{100} \begin{bmatrix} 0.5 \\ 0.5 \end{bmatrix} &\approx& \begin{bmatrix} 0.615 \\ 0.385 \end{bmatrix}, &\dots&
    A^{10000} \begin{bmatrix} 0.5 \\ 0.5 \end{bmatrix} &\approx& \begin{bmatrix} 0.615 \\ 0.385 \end{bmatrix}, &\dots \\[2ex]
    A^{100} \begin{bmatrix} 0.1 \\ 0.1 \end{bmatrix} &\approx& \begin{bmatrix} 0.123 \\ 0.077 \end{bmatrix}, &\dots&
    A^{10000} \begin{bmatrix} 0.1 \\ 0.1 \end{bmatrix} &\approx& \begin{bmatrix} 0.123 \\ 0.077 \end{bmatrix}, &\dots \\[2ex]
    A^{100} \begin{bmatrix} 3 \\ -0.1 \end{bmatrix} &\approx& \begin{bmatrix} 1.785 \\ 1.115 \end{bmatrix}, &\dots&
    A^{10000} \begin{bmatrix} 3 \\ -0.1 \end{bmatrix} &\approx& \begin{bmatrix} 1.785 \\ 1.115 \end{bmatrix}, &\dots
  \end{array}
\]
Part 1 of the pattern: The ratios \(0.615 / 0.385\), \(0.123 / 0.077\), \(0.175 / 1.115\) are \underline{\hspace{2in}}.

Can we see this pattern from the solution? Recall that \(A\) has eigenvectors 
\[
  \vec{u} = \begin{bmatrix} {\color{main} 1} \\ {\color{main} 0.625} \end{bmatrix} \text{ with eigenvalue } {\color{main} \mu = 1}
  \quad\text{and}\quad
  \vec{v} = \begin{bmatrix}1 \\ -1 \end{bmatrix} \text{ with eigenvalue } \lambda = 0.35.
\]

% Moreover, \(\vec{v}(0) = {\color{gray} \frac{1}{0.625}} {\color{main} \vec{u}} + {\color{gray} \frac{0.8125}{1.625}} \vec{v}\), and 

Regardless of the initial condition, the final solution for \(\vec{p}(t+1) = A\vec{p}(t)\) has the form
\[
  \vec{p}(t) = a (1)^{n} {\color{main} \vec{u}} + b (0.35)^{n} \vec{v} = a (1)^{t}  \begin{bmatrix} {\color{main} 1} \\ {\color{main} 0.625} \end{bmatrix}+ b (0.35)^{t} \vec{v}
  \quad\text{where}\quad
  \vec{p}(0) = a \vec{u} + b \vec{v}.
\]

Part 2 of the pattern: \(u_{1} / u_{2} = \underline{\hspace{2in}}\).

Part 3 of the pattern: The eigenvalue \(1\) is the \emph{largest} eigenvalue and \(\vec{u}\) is a corresponding eigenvector.

\faStar{} The above pattern is not a coincidence and allows us to \emph{quickly} determine long-term behaviour for recurrence equations.

\begin{method}[long-term behaviour for recurrence equations (with primitive matricies)]
  For ``nice enough'' matricies \(A\), the following is true:
  \[
    \lim_{t \to \infty} A^{t} \vec{x} = (\text{some constant}) \; (\text{a dominant eigenvector}).
  \]

  The \hlmain{dominant eigenvalue} \(\mu\) is the largest eigenvalue, and a \hlmain{dominant eigenvector} is an eigenvector whose associated eigenvalue is \(\mu\).
\end{method}

\faExclamationTriangle{} We are not required to know what ``nice enough'' means. 

{\footnotesize For those who are interested, the technical term for ``nice enough'' is primitive meaning a matrix \(A\) has only non-negative entries and \(A^{(\text{some power})}\) only contains positive entries (no zeros are allowed).  For example \(A = \begin{bmatrix} 1 & 1 \\ 0 & 1\end{bmatrix}\) is not primitive because no power of \(A\) has only positive entries. However, \(B = \begin{bmatrix} 0 & 1 \\ 1 & 1\end{bmatrix}\) is a primitive matrix because \(B^{2}\) only contains positive entries.}

\clearpage

\begin{example}
  Let \(A = \begin{bmatrix} 0 & 1 \\ 1 & 1/2 \end{bmatrix}\) and \(\vec{u}(0) = \begin{bmatrix} 43278 \\ - 743892\end{bmatrix}\).  Describe the long-term behaviour for \(\vec{u}(t + 1) = A \vec{u}(t)\), i.e., describe \(\lim_{t \to \infty} A^{t} \vec{u}(0)\).

  \blanklines{20}
\end{example}

\begin{example}
  Let \(A = \begin{bmatrix} 1/3 & 1/2 \\ 1 & 0 \end{bmatrix}\).  Describe the long-term behaviour for \(\vec{u}(t + 1) = A \vec{u}(t)\), i.e., describe \(\lim_{t \to \infty} A^{t} \vec{u}(0)\).
  
  \blanklines{20}
\end{example}

\end{document}
